---
title: "Using formr to create R-powered surveys with individualized feedback"
author: "John Paul Helveston"
output:
  xaringan::moon_reader:
    css: ["default", "css/lexis.css", "css/lexis-fonts.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      slideNumberFormat: ""
      ratio: "16:9"
    seal: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    warning = FALSE,
    message = FALSE,
    comment = "#>",
    fig.path = "figs/",
    fig.retina = 3 # Better figure resolution
)
library(knitr)
library(fontawesome)
today <- format(Sys.Date(), format="%B %d %Y")
```

```{r xaringan-tile-view, echo=FALSE}
# Enables the ability to show all slides in a tile overview by pressing "o"
# devtools::install_github("gadenbuie/xaringanExtra")
xaringanExtra::use_tile_view()
```

layout: true

<!-- this adds the link footer to all slides, depends on my-footer class in css-->

<div class="footer-small">
<span>
https://github.com/jhelvy/surveys-with-formr
</span>
</div>

---
name: title-slide
class: inverse, center, middle
background-image: url(images/blackboard.jpg)

# Using {formr} to create `r fa("r-project", fill = "white")` powered surveys<br>with individualized feedback

```{r child="faces.Rmd"}
```

.large[by John Paul Helveston]

`r today`

???

Hi I'm John Helveston, and thanks for tuning in to my lightning talk on how to make R-powered surveys with {formr}

---
class: center, middle

.leftcol[.noborder[
<br><br><br>
<center>
<img src="images/surveymonkey.svg" width=600>
</center>
]]
.rightcol[.noborder[
<center>
<img src="images/google-forms-logo.png" width=500>
</center>
]]

???

If you're someone who has ever had to make a survey, chances are you've probably used one of the free platforms out there, like Survey Monkey or Google Forms.

These platforms work great for simple surveys - they're easy to use, relatively secure, and getting the data from them is pretty straightforward.

---
class: center, middle

.noborder[
<center>
<img src="images/simple-complex.svg" width=900>
</center>
]

???

But what if you needed your survey to be a little more complex, like you wanted to show respondents interactive feedback based on their answers to survey questions?

---
class: center, middle, inverse

```{r child="formr-logo.Rmd"}
```

???

Well, thankfully some really clever people made formr, which uses R and RMarkdown code to create surveys.

---
class: center, middle

.leftcol[.circle[
<center>
<img src="images/ruben.jpg" width=350>
</center>
]
### Ruben C. Arslan
# [`r fa("github")`](https://github.com/rubenarslan) [`r fa("twitter")`](https://twitter.com/rubenarslan)
]
.rightcol[.circle[
<center>
<img src="images/cyril.jpg" width=350>
</center>
]
### Cyril S. Tata
# [`r fa("github")`](https://github.com/cyriltata) [`r fa("twitter")`](https://twitter.com/cyriltata)
]

???

And just to be clear, I'm not one of those clever people. 

Formr was developed by Ruben Arslan and Cyril Tata.

---
class: center, middle, inverse

.leftcol[
# .font200[I `r fa("heart", fill = "red")`]

```{r child="formr-logo.Rmd"}
```
]
.rightcol[.circle[
<center>
<img src="images/helveston.jpg" width=350>
</center>
# [`r fa("github", fill = "white")`](https://github.com/jhelvy) [`r fa("twitter", fill = "white")`](https://twitter.com/JohnHelveston)
]]

???

I'm just a formr super fan, and I made this talk to share it with the rest of the R universe and to demonstrate some of the cool things you can do with it.

---
class: center, middle, inverse

```{r child="formr-logo.Rmd"}
```

# .font200[`r fa("question", fill = "white")`]

???

So what can formr do?

---
class: middle, center, inverse

<style>
.columnnarrow {
  float: left;
  width: 20%;
  padding: 5px;
}
</style>

.leftcol[.noborder[
<br><br><br><br><img src="images/surveymonkey.svg">
]]
.columnnarrow[<br><br>
# .font200[`r fa("plus", fill = "white")`]
]
.rightcol30[
<center>
<img src="https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/rmarkdown.png">
</center>
]

???

Well, I kind of think it like Survey Monkey plus RMarkdown.

Basically, you can use it create simple surveys like most online survey platforms, but you can also use R code to generate a much richer set of features.

---
class: middle, center

<center>
<img src="images/htmlwidgets.gif" width=700>
</center>

https://formr.org/interactive_charts

???

For example, you could generate interactive charts that the survey respondent could experience while taking the survey.

---
class: middle, center

.noborder[
<center>
<img src="images/feedback.png" width=820>
</center>
]

.left[.font70[Fig. 3 from Arslan, R.C., Walther, M.P. & Tata, C.S. [formr: A study framework allowing for automated feedback generation and complex longitudinal experience-sampling studies using R](https://link.springer.com/article/10.3758/s13428-019-01236-y). Behav Res 52, 376â€“387 (2020).]]

???

Or you could use R code to generate dynamic feedback for survey respondents.

For example, a chart like this was dynamically generated for each respondent in a longitudinal study showing how their risk preferences compared to others based on their answers to previous questions.

---
class: middle, center, inverse

# .font200[how]

```{r child="formr-logo.Rmd"}
```

# .font200[works]

???

So how does it work?

---
class: center, middle
background-color: #FFFFFF

.leftcol40[.noborder[
<center>
<img src="images/google-sheets-logo.png" width=500>
</center>
]]
.columnnarrow[<br><br><br>
# .font200[`r fa("plus", fill = "black")`]
]
.rightcol40[.noborder[
<center>
<img src="images/opencpu.jpeg" width=300>
</center>
# .font150[OpenCPU]

(Thanks to Jeroen Ooms! [`r fa("twitter", fill = "blue")`](https://twitter.com/opencpu))
]]

???

formr relies on two platforms to create surveys

The text and code for each survey are input using a spreadsheet, like Google sheets, 

and once the survey is live, R code is computed using Open CPU

---
class: center, middle
background-image: url(images/googlesheet0.png)
background-size: contain

???

Here is an example Googlesheet for a simple survey.

Each row is an item that will be displayed on the survey.

Each column controls what will be shown.

---
class: center, middle
background-image: url(images/googlesheet1.png)
background-size: contain

???

The "label" column is where you insert markdown or code chunks that you want to display in the survey. 

---
class: center, middle
background-image: url(images/googlesheet2.png)
background-size: contain

???

The "type" column is where you set the type of each question to show.

You can choose from a long list of options, like multiple choice, text entry, or simply just display text or images.

---
class: center, middle
background-image: url(images/googlesheet3.png)
background-size: contain

???

Depending on the type of question, you may also have some options for respondents to choose from, like in a multiple choice question.

---
class: center, middle
background-image: url(images/googlesheet4.png)
background-size: contain

???

And you can also customize the look and feel with some styling options

---
class: middle

.noborder[
<center>
<img src="images/screenshot-upload.png" width=1000>
</center>
]

???

Once you've got your spreadsheet ready, you can login to formr.org, input the link to your Googlesheet, and your sheet will be converted into a survey.

---
class: center, middle
background-image: url(images/screenshot-apple.png)
background-size: contain

???

The example Google sheet I just showed generates a survey with multiple choice questions about apples that look like this.

---

# .center[The {formr} package]

.leftcol70[
```{r, eval=FALSE}
library(formr) #<<

# Connect to formr
formr_connect( #<<
  email    = 'youremail@gmail.com', #<<
  password = '*****') #<<

# Import raw data
raw <- formr_raw_results(survey_name = 'apple_survey') #<<

# Save raw data
write_csv(raw, here::here('raw_data.csv'))
```
]

???

Of course, once you've fielded your survey, you'll want to access the data. 

This can be downloaded from your account admin page or imported into R using the formr package, which has convenient functions for connecting to your account and importing results.

---
class: middle, center, inverse

# .font140[Showing randomized images]
<br>
# .font140[Timed, randomized quizzes]

???

Now that we know a little bit about how formr works, I'd like to spend my last couple minutes showing how I've used formr in my own work.

---
class: middle, center, inverse

# .orange[.font140[Showing randomized images]]
<br>
# .font140[Timed, randomized quizzes]

???

I'll start with an example showing people randomized images in a research method known as conjoint analysis.

---
class: center, middle
background-image: url(images/screenshot-conjoint.png)
background-size: contain

???

In conjoint surveys, you ask people to choose from randomized profiles of different products, then you can use that choice data to estimate their preferences for attributes of those products. 

So, if I wanted to know how much people felt about the price and freshness of different apples, I could show them profiles like this, and in each question I'll vary the values shown.

---
class: middle

.code60[
```{r, echo=FALSE}
design <- read.csv("https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/doe.csv")

head(design)
```
]
.noborder[
<center>
<img src="images/screenshot-conjoint.png" width=800>
</center>
]

???

I can also pre-define the profiles in a data frame, then use those values to dynamically create the profiles shown in the survey.

---
class: middle, center, inverse

# .font140[Showing randomized images]
<br>
# .orange[.font140[Timed, randomized quizzes]]

???

I've also used formr to create timed, randomized quizzes for my classes.

---
class: center, middle

.leftcol[.noborder[
.left[
```{r, eval=FALSE}
sample(c("A", "B"), size = 1)
```
```
"A"
```
]
<center>
<img src="images/screenshot-quiz1.png">
</center>
]]
.rightcol[.noborder[
.left[
```{r, eval=FALSE}
sample(c("A", "B"), size = 1)
```
```
"B"
```
]
<center>
<img src="images/screenshot-quiz2.png">
</center>
]]

???

I do this by creating two versions of every question on a quiz. 

Then I use the sample function to randomly choose each version of each question. 

This results in a unique quiz for nearly every student.

---
class: center, middle

.leftcol[
## Number of admin accounts
<center>
<img src="images/formr-admin-users.png">
</center>
]
.rightcol[
## Number of surveys taken
<center>
<img src="images/formr-users.png" width=510>
</center>
]

???

formr has now been around for several years, and there's a growing user base as well as a very active support group with lots of great examples.

---
class: center, middle, inverse, no-slide-number

# .font150[Thanks!]

```{r child="faces.Rmd"}
```

## https://formr.org/

.footer-large[
.right[
[@johnhelveston `r fa(name = "twitter", fill = "white")`](http://twitter.com/johnhelveston)<br>
[@jhelvy `r fa(name = "github", fill = "white")`](http://github.com/jhelvy)<br>
[@jhelvy `r fa(name = "weixin", fill = "white")`](http://www.box.jhelvy.com/docs/jhelvy.png)<br>
[jhelvy.com `r fa(name = "link", fill = "white")`](https://www.jhelvy.com)<br>
[jph@gwu.edu `r fa(name = "paper-plane", fill = "white")`](mailto:jph@gwu.edu)
]]

???

So head on over to formr.org, and start making some R-powered surveys!
